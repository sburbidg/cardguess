<script>
  var suitnames = ['Hearts', 'Diamonds', 'Spades', 'Clubs'];
  var numbers = ['Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten', 'Jack', 'Queen', 'King', 'Ace'] 
  
  function Deck() { 
    this.cards = [];
    this.count = function() {
        this.cards.length;
    }
    
    this.init = function() {
      for (r =  1; r <= 13; r++) {
        for (s = 1; s <= 4; s++) 
        {this.cards.push(new Card(s, r))
        }       
      }
      this.shuffle()
    }

    this.shuffle = function(){
      var copy = [], n = this.cards.length, rand, take;
      while (n) {
        rand = Math.floor(Math.random() * n--)
        take = this.cards.splice(rand, 1)[0] 
        copy.push(take);
      }
      return this.cards = copy
    } 
  }
  

  function Card(suit, rank) {
    this.rank = rank;
    this.suit = suit;
        this.show = function() {
            console.log('You pulled a ' + numbers[this.rank - 1] + " of " + suitnames[this.suit - 1]);  
        }
    this.label = function() {return numbers[this.rank - 1] + " of " + suitnames[this.suit - 1] 
    }    
  }           
 
  
  function War(deck) {

    
    this.dealOne = function(deck) {
      var midDeck, oneDeal
      midDeck = deck.cards.length / 2
      oneDeal = deck.cards.slice(0, midDeck)
      return oneDeal
    }
  
    this.dealTwo = function(deck) {
      var midDeck, twoDeal
      midDeck = deck.cards.length / 2
      twoDeal = deck.cards.slice(midDeck, 52)
      return twoDeal 
    }

    this.checkPop = function(cards){
      if(cards.length > 0){
        return cards.pop()
      } else {
        return null
      }
    }
    
    this.checkUnshift = function(cards, card){
      if (card != null){ 
        cards.unshift(card)
      }
    }
      

    this.round = function() {
      var tiePile = []
      var done = false
      while(!done) {
        var playerOnecard = this.playerOne.pop()
        var playerTwocard = this.playerTwo.pop()
        if (playerOnecard.rank > playerTwocard.rank) {
          console.log('Player one played a ' + playerOnecard.label() + ' and player two played a ' + 
            playerTwocard.label() + '. Player one takes the cards')
          this.playerOne.unshift(playerOnecard)
          this.playerOne.unshift(playerTwocard)
          this.playerOne = tiePile.concat(this.playerOne)
          tiePile = []
          done = true

        }
        else if(playerOnecard.rank <  playerTwocard.rank) {
          console.log('Player one played a ' + playerOnecard.label() + 
          ' and player two played a ' + playerTwocard.label() + '. Player two takes the cards')
          this.playerTwo.unshift(playerOnecard)
          this.playerTwo.unshift(playerTwocard)
          this.playerTwo = tiePile.concat(this.playerTwo)
          tiePile = []
          done = true
        }
        else {
            console.log('Player one played a ' + playerOnecard.label() + ' and player two played a ' + playerTwocard.label()
         + '. It\'s a tie. Put down three cards each and try again.')
          this.checkUnshift(tiePile, this.checkPop(this.playerOne))
          this.checkUnshift(tiePile, this.checkPop(this.playerOne))
          this.checkUnshift(tiePile, this.checkPop(this.playerOne))
          this.checkUnshift(tiePile, this.checkPop(this.playerTwo))
          this.checkUnshift(tiePile, this.checkPop(this.playerTwo))
          this.checkUnshift(tiePile, this.checkPop(this.playerTwo))
          tiePile.push(playerOnecard, playerTwocard)
           
          } 
        }
      }
    
      this.play = function(){
      var roundCount = 1
      while(this.playerOne.length > 0 && this.playerTwo.length > 0){
      this.round()
        if(roundCount++ % 5 == 0) {
          console.log('player one currently has ' + this.playerOne.length + ' cards \n' 
            + 'player two currently has ' + this.playerTwo.length + ' cards')
        }
      }
    }

    this.playerOne = this.dealOne(deck)
    this.playerTwo = this.dealTwo(deck)
  }
  var d = new Deck();
  d.init();
  var w = new War(d)
  w.play()
    
    //console.log(playerTwo.pop())
  


  //while(this.cards.length > 0)
  


   

</script>